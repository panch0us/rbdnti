{% extends "news_site/base.html" %}

{% block title %}{{ section.title }} - {{ category.title }}{% endblock %}

{% block content %}
<!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
<nav class="breadcrumb">
    <a href="{% url 'news_site:index' %}">–ì–ª–∞–≤–Ω–∞—è</a> 
    <span style="margin: 0 10px;">/</span>
    <a href="{% url 'news_site:section' section.slug %}">{{ section.title }}</a>
    <span style="margin: 0 10px;">/</span>
    <span>{{ category.get_full_path }}</span>
</nav>

<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
<h1 class="section-title">{{ category.title }}</h1>

<!-- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
{% if subcategories %}
<div class="category-tree">
    <h3 style="margin-bottom: 20px; color: var(--primary-color);">–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
    
    <div class="subcategories">
        {% for subcategory in subcategories %}
        <div class="subcategory-item">
            <a href="{% url 'news_site:category' section.slug subcategory.get_path %}" class="category-link">
                <div class="category-header">
                    <h4 class="category-title">{{ subcategory.title }}</h4>
                    <div class="category-meta">
                        –ù–æ–≤–æ—Å—Ç–µ–π: {{ subcategory.news.count }}
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- –ù–æ–≤–æ—Å—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
{% if news %}
<div class="news-section">
    <h3 style="margin-bottom: 20px; color: var(--primary-color);">–ù–æ–≤–æ—Å—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
    <div class="news-list">
        {% for news_item in news %}
        <div class="news-item">
            <div class="news-header">
                <h4 class="news-title">
                    <a href="{% url 'news_site:news_detail' news_item.id %}" style="color: inherit; text-decoration: none;">
                        {{ news_item.title }}
                    </a>
                </h4>
                <div class="news-date">{{ news_item.created_at|date:"d.m.Y H:i" }}</div>
            </div>
            
            <div class="news-content">
                {{ news_item.content|linebreaks|truncatewords:50 }}
            </div>
            
            {% if news_item.files.all %}
            <div class="news-files">
                {% for file in news_item.files.all %}
                <a href="{{ file.file.url }}" download class="file-badge">
                    üìé {{ file.filename }}
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="category-item">
    <p>–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π.</p>
</div>
{% endif %}
{% endblock %}